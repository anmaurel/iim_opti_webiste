jQuery(function(m){var e,l,c,_=(l=("https:"==location.protocol?"https:":"http:")+"//formoid.net/api/push",c=8==(e=(/MSIE (\d+)\./.exec(navigator.userAgent)||[0,0])[1])||9==e&&"file:"!=location.protocol?function(e,t){var a=new XDomainRequest,r=m.Deferred();return a.open(t.type,e),a.onload=function(){r.resolve(this.responseText)},a.onerror=function(){r.reject()},a.send(t.data),r}:(m.support.cors=!0,m.ajax),a.prototype.email=function(e){return t.call(this,"email",arguments)},a.prototype.title=function(e){return t.call(this,"title",arguments)},a.prototype.recaptcha_token=function(e){return t.call(this,"recaptcha_token",arguments)},a.prototype.data=function(e){return t.call(this,"data",arguments)},a.prototype.getCaptchaToken=function(){var e=this.__recaptcha__,t=m.Deferred();return e?grecaptcha.ready(function(){try{grecaptcha.execute(e,{action:"homepage"}).then(function(e){t.resolve(e)})}catch(e){console.error(e),t.resolve(null)}}):t.resolve(null),t.promise()},a.prototype.send=function(t,e){var a,r,n,o=this,i=(a=m.Deferred(),r=this,n=["email","title","data","send"],m.each(n,function(e,t){a[t]=function(){return r[t].apply(r,arguments)}}),a),s=this.__recaptcha__?this.getCaptchaToken():m.when();return e&&(e.call(this,i),"pending"!=i.state())||s.then(function(e){e&&(o.__rcph_token__=e)}).always(function(){var e={email:o.__email__,form:{title:o.__title__,data:arguments.length?t:o.__data__}};o.__rcph_token__&&(e.recaptcha_token=o.__rcph_token__),c(l,{type:"POST",data:JSON.stringify(e)}).done(function(e){try{var t=JSON.parse(e);t.error?i.reject(t.error):i.resolve(t.response)}catch(e){i.reject("Incorrect server response.")}}).fail(function(){var e="Failed to query the server. ";"onLine"in navigator&&!navigator.onLine?e+="No connection to the Internet.":e+="Check the connection and try again.",i.reject(e)})}),i},{Form:function(e){return new a(e)}});function t(e,t){return e="__"+e+"__",t.length?(this[e]=t[0],this):this[e]}function a(e){e=e||{},this.__email__=e.email||"",this.__title__=e.title||"",this.__data__=e.data||[],this.__recaptcha__=e.recaptcha||""}m('[data-form-type="formoid"]').each(function(){var r,n=m(this),o=n.is("form")?n:n.find("form"),p=(o.attr("action"),n.find("[data-form-alert]")),i=n.is("[data-form-title]")?n:n.find("[data-form-title]"),u=n.find('[type="submit"]'),s=o.find("[data-form-field]"),l=o.find("[data-form-alert]").length?p.html():p.find("[data-form-alert-success]").html();n.find("[data-form-captcha]");o.change(function(e){"file"===e.target.type&&1e6<e.target.files[0].size&&(p.removeAttr("hidden"),p.removeClass("alert-success").addClass("alert-danger"),p.html("File size must be less than 1mb"),u.addClass("btn-loading").prop("disabled",!0))}),s.each(function(e,t){m(t).on("focus",function(){p.attr("hidden","hidden"),p.addClass("alert-success").removeClass("alert-danger"),p.html(""),u.removeClass("btn-loading").prop("disabled",!1)})}),o.submit(function(e){var d,t,a,f,h;e.preventDefault(),u.hasClass("btn-loading")||(d=[],t=s,o.addClass("form-active"),u.addClass("btn-loading").prop("disabled",!0),p.html(""),r=r||_.Form({email:n.find("[data-form-email]").val(),title:i.attr("data-form-title")||i.text(),recaptcha:n.find("[data-form-captcha]").val()||!1}),a=t,f=m.Deferred(),h=[],a.each(function(e,t){var a,r,n=m(t),o=n.attr("type"),i=m.Deferred();if(h.push(i),"email"===n.attr("name")&&(a=!0,(r=m(t).val())&&(a=/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i.test(r)),!a))return u.removeClass("btn-loading").prop("disabled",!0),f.reject(new Error("Form is not valid")),!1;switch(o){case"file":var s=new FileReader,l=n.attr("data-form-field")||n.attr("name"),c=n[0].files[0];s.onloadend=function(){d.push([l,s.result]),i.resolve()},s.onerror=function(){p.html(s.error),f.reject(s.error)},c&&s.readAsDataURL(c);break;case"checkbox":d.push([n.attr("data-form-field")||n.attr("name"),n.prop("checked")?n.val():"No"]),i.resolve();break;case"radio":n.prop("checked")&&d.push([n.attr("data-form-field")||n.attr("name"),n.val()]),i.resolve();break;default:d.push([n.attr("data-form-field")||n.attr("name"),n.val()]),i.resolve()}}),f.resolve(h).then(function(e){m.when.apply(this,e).then(function(){r.send(d).always(function(){u.removeClass("btn-loading").prop("disabled",!1),p.removeAttr("hidden")}).then(function(e){o[0].reset(),o.removeClass("form-active"),p.text(l||e),p.removeClass("alert-danger").addClass("alert-success")}).fail(function(e){p.text(e),p.removeClass("alert-success").addClass("alert-danger")})},function(e){p.html(e.message),p.removeClass("alert-success").addClass("alert-danger"),p.removeAttr("hidden")})}))})})});